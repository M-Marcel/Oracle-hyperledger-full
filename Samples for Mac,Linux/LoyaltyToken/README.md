# LoyaltyToken

# This project was generated by Oracle Blockchain App Builder

This application constitutes a custom chaincode service for use within
[Oracle Blockchain Platform] (https://www.oracle.com/blockchain/)

# Working with the LoyaltyToken Specification File

A typical workflow, starting with the sample token specification file, is shown in the following steps.
1.	Scaffold the token chaincode project in the Go programming language from the LoyaltyToken.yml specification file.
2.	Copy the custom code of the following methods from the downloaded sample file "LoyaltyToken.controller.go" (which is placed under LoyaltyToken/src/LoyaltyToken.controller.go) and paste it in the scaffolded chaincode file <scaffolded_chaincode_name>.controller.go – 
•	InitializeMerchant
•	InitializeConsumer 
•	RewardLoyaltyTokens
•	RedeemLoyaltyTokens
Save the file.
3.	**Deploy the scaffolded chaincode using Blockchain App Builder**: When you instantiate the token chaincode, pass the org_id and user_id of the token admin user. The org_id value is the organization ID or the membership service provider (MSP) ID of the token user. The user_id value is the username or email address of the token user; for example, the Oracle Identity Cloud Service user ID. 

Please create enrollment IDs for each token user and map the token users to their respective enrollment IDs. You need to specify one and only one user for each enrollment.
For more information about adding enrollments, please refer the link below -
https://docs.oracle.com/en/cloud/paas/blockchain-cloud/usingoci/manage-rest-proxy-nodes.html#GUID-133EA460-DE56-4003-85D5-B77FE7A91BD7

Token admin users can initialize tokens, create accounts, and add roles to users. Any token admin user can also add or remove other users as token admin users.
4.	Set up accounts and roles to test the token chaincode.
a.	Log in as the user who is the token admin.
b.	Invoke the InitializeLoyalTOKToken method to initialize a new token with the behaviors that are specified in the specification file.
c.	Use the custom method InitializeMerchant to create accounts for the airline company user and partners such as a car rental company user for token transactions. When you create an account, you specify the org_id, user_id, and token_type values. Token_type value will be "fungible". 
d.  Invoke AssociateTokenToMerchantAccount method to associate the account to the token by passing the account id from step 4c and token id from step 4b.
e.	Use the custom method InitializeConsumer to create accounts for flight traveler users for token transactions. When you create an account, you specify the org_id, user_id, and token_type values. Token_type value will be "fungible".  
d.  Invoke AssociateTokenToConsumerAccount method to associate the account to the token by passing the account id from step 4e and token id from step 4b.
f.	Invoke the AddRole method to assign the minter role to the airline company user. In this scenario, only the airline company user can mint tokens.
g.	Use the method GetMerchantDetailsByRange to get account details of the airline company user and car rental company user.
h.	Use the method GetConsumerLoyaltyByRange to get account details of the flight traveler users.
5.	Test the token chaincode by minting and rewarding tokens by the airline company user.
a.	Log in as the user with the minter role (the airline company user).
b.	Invoke the IssueTokens method to mint tokens to the airline company user's account. The amount of tokens that you can mint must be less than or equal to the max_mint_quantity value that is specified in the LoyaltyToken.yml file.
c.	Invoke the custom method RewardLoyaltyTokens to transfer tokens from the airline company user to the flight traveler users.
d.	Invoke the GetAccountTransactionHistory method and check the result to see the transaction history of the airline company user's account.
6.	Test the token chaincode by redeeming the tokens by flight travelers.
a.	Log in as the flight traveler user.
b.	Invoke the custom method RedeemLoyaltyTokens to redeem tokens by the flight traveler user with a partner such as the car rental company user. 
c.	Invoke the GetAccountTransactionHistory method and check the result to see the transaction history of the flight traveler user's account.
7.	Test the token chaincode by burning tokens in the car rental company account.
a.	Log in as the car rental company user.
b.	Invoke the BurnTokens method to burn tokens in the car rental company user's account. Because the burner role is not specified in the specification file, any user can burn tokens in their own account.
c.	Invoke the GetAccountTransactionHistory method and check the result to see the transaction history of the car rental company user's account.

**Instructions to import the Postman collection file and execute requests**:
- Import the collection file “Airline Loyalty Program - Go Specific.postman_collection" in Postman (version-8.5.1 or later).
- Click the "Airline Loyalty Program - Go Specific" collection name.
- Go to the variables tab under the “Airline Loyalty Program - Go Specific" collection.
- Update and save the variable values.
- Execute the requests according to the sequence mentioned in the collection file.

**Note**:
- To execute the ready-to-use sample chaincodes (which are placed under the LoyaltyToken folder), complete the following steps: 
1. If you're working with the Go programming language, copy the extracted LoyaltyToken folder to the following location: `$GOPATH\src\example.com\LoyaltyToken`
2. Update the value of the "configFileLocation" key in the .ochain.json file in the LoyaltyToken folder to any valid specification file on your system.
